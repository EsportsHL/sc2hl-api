box: fauda/nodejs-deploy
build:
    steps:
        - script:
            name: install npm packages
            code: sudo npm install
deploy:
    steps:
        - add-to-known_hosts:
            hostname: api.sc2hl.com
        - add-ssh-key:
            keyname: KEY
        - script:
            name: rsync files
            code: rsync -av -e "ssh -i $KEY_PRIVATE" --delete --exclude 'config.js' -r . wercker@api.sc2hl.com:/var/www/api-sc2hl/$WERCKER_GIT_BRANCH
        - script:
            name: restart server
            code: ssh wercker@api.sc2hl.com "forever restartall"
